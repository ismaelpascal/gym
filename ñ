<?php
$servidor = 'localhost';
$usuario = 'root';
$clave = '';
$baseDeDatos = 'gym';

$enlace = mysqli_connect($servidor, $usuario, $clave, $baseDeDatos);//intenta conectarse a la base de datos con esos datos.

if (!$enlace) {
    die("Conexión fallida: " . mysqli_connect_error());//Intento de conexión a la base de datos; si falla, muestra un error y detiene la ejecución del resto del codigo.
}

if ($_SERVER["REQUEST_METHOD"] == "POST") {//verifica si el formulario fue enviado.
    $nombre = mysqli_real_escape_string($enlace, $_POST['nombre']);//$_POST['campo']: obtiene los datos que el usuario ingresó en cada campo del formulario.
    $apellido = mysqli_real_escape_string($enlace, $_POST['apellido']);//mysqli_real_escape_string: escapa caracteres especiales para evitar inyecciones SQL. Esto protege la base de datos de ataques maliciosos.
    $dni = mysqli_real_escape_string($enlace, $_POST['dni']);
    $fechaNac = mysqli_real_escape_string($enlace, $_POST['fechaNac']);
    $domicilio = mysqli_real_escape_string($enlace, $_POST['domicilio']);
    $telefono = mysqli_real_escape_string($enlace, $_POST['telefono']);

    $sql = "INSERT INTO socios (nombre, apellido, dni, fecha_nacimiento, domicilio, telefono)
            VALUES ('$nombre', '$apellido', '$dni', '$fechaNac', '$domicilio', '$telefono')";

    if (mysqli_query($enlace, $sql)) {
        $mensaje = "<p style='color:green;'>Socio agregado correctamente</p>";
    } else {
        $mensaje = "<p style='color:red;'>Error: " . mysqli_error($enlace) . "</p>";
    }
}
/*Crea la consulta SQL para insertar los datos del formulario en la tabla socios.
mysqli_query($enlace, $sql): ejecuta la consulta.
Si la inserción es correcta, muestra un mensaje verde de éxito.
Si hay un error (por ejemplo, el DNI ya existe), muestra un mensaje rojo con el error.*/ 
?>

<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Formulario Socios</title>
    <link rel="stylesheet" href="css/estilos.css">
</head>
<body>

<form method="POST" action="">
    <label for="nombre">Nombre:</label>
    <input type="text" name="nombre" required><br><br>

    <label for="apellido">Apellido:</label>
    <input type="text" name="apellido" required><br><br>

    <label for="dni">DNI:</label>
    <input type="number" name="dni" required><br><br>

    <label for="fechaNac">Fecha de nacimiento:</label>
    <input type="date" name="fechaNac" required><br><br>

    <label for="domicilio">Domicilio:</label>
    <input type="text" name="domicilio" required><br><br>

    <label for="telefono">Teléfono:</label>
    <input type="tel" name="telefono" required><br><br>

    <button type="submit">Guardar</button>
</form>

<?php

if (isset($mensaje)) { //isset() verifica si la variable $mensaje existe y no es null.
    echo $mensaje;      /*Si el formulario ya fue enviado y se creó $mensaje, entonces se muestra en pantalla. 
                        Si el formulario no se envió todavía, PHP ignora el echo y no da errores.*/
}
?>